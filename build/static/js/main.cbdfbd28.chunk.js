(this.webpackJsonpinclassdemo=this.webpackJsonpinclassdemo||[]).push([[0],{112:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(28),o=a.n(r),s=a(6),i=a(13),d=a(16),l=a(119),j=a(34);function u(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function b(e,t){switch(t.type){case"CREATE_TODO":return[{id:t.id,title:t.title,content:t.description,author:t.author,completed:!1,dateCompleted:-1,hidden:!1}].concat(Object(j.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e.id===t.todoId&&(e.completed=t.completed,e.dateCompleted=t.dateCompleted),e}));case"DELETE_TODO":return e.filter((function(e){return e.id!==t.todoId}));case"FETCH_TODOS":return console.log("fetch:",t),t.todos;default:return e}}function O(e,t){return console.log("---",e,t),{user:u(e.user,t),todos:b(e.todos,t)}}var h=a(9),p=a(12),x=a(1);function f(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(""),o=Object(s.a)(r,2),i=o[0],l=o[1],j=Object(d.d)(),u=Object(n.useContext)(h.a),b=u.state,O=u.dispatch,f=b.user,m=Object(p.b)((function(e){var t=e.title,a=e.description,n=e.author;return{url:"/todo",method:"post",headers:{Authorization:"".concat(b.user.access_token)},data:{title:t,description:a,author:n,dateCreated:Date.now(),complete:!1,dateCompleted:-1,hidden:!1}}})),g=Object(s.a)(m,2),v=g[0],C=g[1];return Object(n.useEffect)((function(){v&&v.data&&(O({type:"CREATE_TODO",title:v.data.title,description:v.data.description,id:v.data.id,author:f.username}),console.log(v.data),j.navigate("/todo/".concat(v.data.id)))}),[v]),Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),C({title:a,description:i,author:f.username})},children:[Object(x.jsxs)("div",{children:["Author: ",Object(x.jsx)("b",{children:f.username})]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(x.jsx)("input",{type:"text",value:a,onChange:function(e){c(e.target.value)},name:"create-title",id:"create-title"})]}),Object(x.jsx)("textarea",{value:i,onChange:function(e){l(e.target.value)}}),Object(x.jsx)("input",{type:"submit",value:"Create"})]})}var m=a(2),g=a(125),v=a(80);function C(e){var t=e.title,a=e.description,c=e.author,r=e.completed,o=e.dateCompleted,i=e.todoId,l=e.short,j=void 0!==l&&l,u=Object(n.useContext)(h.b).secondaryColor,b=Object(n.useContext)(h.a).dispatch,O=Object(p.b)((function(e){return{url:"/todos/".concat(e),method:"delete"}})),f=Object(s.a)(O,2),m=f[0],C=f[1],w=Object(p.b)((function(e,t){return{url:"/todos/".concat(e),method:"patch",data:{completed:t,dateCompleted:Date.now()}}})),y=Object(s.a)(w,2),T=y[0],E=y[1];Object(n.useEffect)((function(){m&&m.data&&!1===m.isLoading&&b({type:"DELETE_TODO",todoId:i})}),[m]),Object(n.useEffect)((function(){T&&T.data&&!1===T.isLoading&&b({type:"TOGGLE_TODO",completed:T.data.completed,dateCompleted:T.data.dateCompleted,todoId:i})}),[T]);var k=a;return j&&a.length>30&&(k=a.substring(0,30)+"..."),Object(x.jsx)(g.a,{children:Object(x.jsxs)(g.a.Body,{children:[Object(x.jsx)(g.a.Title,{children:Object(x.jsx)(d.a,{style:{color:u},href:"/todo/".concat(i),children:t})}),Object(x.jsx)(g.a.Subtitle,{children:Object(x.jsxs)("i",{children:["Written by ",Object(x.jsx)("b",{children:c})]})}),Object(x.jsx)(g.a.Text,{children:k}),Object(x.jsx)("input",{type:"checkbox",checked:r,onChange:function(e){E(i,e.target.checked)}}),Object(x.jsx)(v.a,{variant:"link",onClick:function(e){C(i)},children:"Delete Todo"}),r&&Object(x.jsxs)("i",{children:["Completed on: ",new Date(o).toLocaleDateString("en-us")]}),j&&Object(x.jsx)(d.a,{href:"/todo/".concat(i),children:"View full todo"})]})})}var w=c.a.memo(C);function y(e){var t=e.id,a=Object(n.useContext)(h.a).state,c=Object(p.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(a.user.access_token)},method:"get"}})),r=Object(s.a)(c,2),o=r[0],i=r[1];return Object(n.useEffect)(i,[t]),Object(x.jsxs)("div",{children:[o&&o.data?Object(x.jsx)(w,Object(m.a)({},o.data)):"Loading...",Object(x.jsx)("div",{children:Object(x.jsx)(d.a,{href:"/",children:"Go back"})})]})}var T=a(123),E=a(121);function k(e){var t=e.show,a=e.handleClose,c=Object(n.useContext)(h.a).dispatch,r=Object(n.useState)({username:"",password:"",passwordRepeat:""}),o=Object(s.a)(r,2),i=o[0],d=o[1],l=Object(n.useState)(""),j=Object(s.a)(l,2),u=(j[0],j[1]),b=Object(p.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),O=Object(s.a)(b,2),f=O[0],g=O[1];return Object(n.useEffect)((function(){f&&f.data&&c({type:"REGISTER",username:f.data.username})}),[f]),Object(n.useEffect)((function(){f&&!1===f.isLoading&&(f.data||f.error)&&(f.error?(console.log(f),u("Registration failed, please try again later."),alert("fail")):(console.log(f),u("Registration successful. You may now login."),alert("success")))}),[f]),Object(x.jsx)(T.a,{show:t,onHide:a,children:Object(x.jsxs)(E.a,{onSubmit:function(e){e.preventDefault(),g(i.username,i.password),a()},children:[Object(x.jsx)(T.a.Header,{closeButton:!0,children:Object(x.jsx)(T.a.Title,{children:"Register"})}),Object(x.jsxs)(T.a.Body,{children:[Object(x.jsx)(E.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(x.jsx)(E.a.Control,{type:"text",value:i.username,onChange:function(e){return d(Object(m.a)(Object(m.a)({},i),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(x.jsx)(E.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(x.jsx)(E.a.Control,{type:"password",name:"register-password",id:"register-password",value:i.password,onChange:function(e){return d(Object(m.a)(Object(m.a)({},i),{},{password:e.target.value}))}}),Object(x.jsx)(E.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(x.jsx)(E.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:i.passwordRepeat,onChange:function(e){return d(Object(m.a)(Object(m.a)({},i),{},{passwordRepeat:e.target.value}))}})]}),Object(x.jsxs)(T.a.Footer,{children:[Object(x.jsx)(v.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(x.jsx)(v.a,{variant:"primary",type:"submit",disabled:0===i.username.length||0===i.password.length||i.password!==i.passwordRepeat,children:"Register"})]})]})})}function L(e){var t=e.show,a=e.handleClose,c=Object(n.useContext)(h.a).dispatch,r=Object(n.useState)(""),o=Object(s.a)(r,2),i=o[0],d=o[1],l=Object(n.useState)(""),j=Object(s.a)(l,2),u=j[0],b=j[1],O=Object(n.useState)(!1),f=Object(s.a)(O,2),m=f[0],g=f[1];var C=Object(p.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),w=Object(s.a)(C,2),y=w[0],k=w[1];return Object(n.useEffect)((function(){y&&!1===y.isLoading&&(y.data||y.error)&&(y.error?(g(!0),alert("failed")):(g(!1),console.log(y.data),c({type:"LOGIN",username:i,access_token:y.data.access_token})))}),[y]),Object(x.jsx)(T.a,{show:t,onHide:a,children:Object(x.jsxs)(E.a,{onSubmit:function(e){e.preventDefault(),k(i,u),a()},children:[Object(x.jsx)(T.a.Header,{closeButton:!0,children:Object(x.jsx)(T.a.Title,{children:"Login"})}),Object(x.jsxs)(T.a.Body,{children:[Object(x.jsx)(E.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(x.jsx)(E.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(x.jsx)(E.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(x.jsx)(E.a.Control,{type:"password",value:u,onChange:function(e){b(e.target.value)},name:"login-password",id:"login-password"}),m&&Object(x.jsx)(E.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(x.jsxs)(T.a.Footer,{children:[Object(x.jsx)(v.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(x.jsx)(v.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})}function S(){var e=c.a.lazy((function(){return a.e(3).then(a.bind(null,126))})),t=Object(n.useContext)(h.a).state,r=Object(n.useState)(!1),o=Object(s.a)(r,2),i=o[0],d=o[1],l=Object(n.useState)(!1),j=Object(s.a)(l,2),u=j[0],b=j[1];return t.user.username?Object(x.jsx)(e,{}):Object(x.jsxs)("div",{className:"justify-content-end",children:[Object(x.jsx)(v.a,{variant:"link",onClick:function(e){return d(!0)},children:"Login"}),Object(x.jsx)(L,{show:i,handleClose:function(){return d(!1)}}),Object(x.jsx)(v.a,{variant:"link",onClick:function(e){return b(!0)},children:"Register"}),Object(x.jsx)(k,{show:u,handleClose:function(){return b(!1)}})]})}var D=a(122),R=function(e){var t=e.text,a=Object(n.useContext)(h.b);return Object(x.jsx)(d.a,{href:"/",children:Object(x.jsx)(D.a.Brand,{style:{color:a.primaryColor},children:t})})};a(120);var _=a(124);function I(e){e.setTheme,Object(n.useContext)(h.b);var t=Object(n.useContext)(h.a).state.user;return Object(x.jsx)(D.a,{bg:"light",expand:"lg",children:Object(x.jsxs)(l.a,{children:[Object(x.jsx)(D.a.Brand,{href:"/",children:Object(x.jsx)(R,{text:"My Blog"})}),Object(x.jsx)(D.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(x.jsxs)(D.a.Collapse,{id:"basic-navbar-nav",children:[Object(x.jsx)(_.a,{className:"me-auto",children:t.username&&Object(x.jsx)(_.a.Link,{children:Object(x.jsx)(d.a,{href:"/todo/create",children:"Create New Todo"})})}),Object(x.jsx)(c.a.Suspense,{fallback:"Loading...",children:Object(x.jsx)(S,{})})]})]})})}function F(){var e=Object(n.useContext)(h.a).state,t=e.todos;return console.log(e,t),Object(x.jsx)("div",{children:t.map((function(e,t){return Object(n.createElement)(w,Object(m.a)(Object(m.a)({},e),{},{short:!0,title:e.title,author:e.author,key:"todo-"+t,todoId:e.id}))}))})}function G(){var e=Object(n.useContext)(h.a),t=e.state,a=e.dispatch;console.log("state",t);var c=Object(p.b)((function(){return{url:"/todo",method:"get"}})),r=Object(s.a)(c,2),o=r[0],i=r[1];Object(n.useEffect)((function(){i()}),[t.user.access_token]),Object(n.useEffect)((function(){o&&!1===o.isLoading&&o.data&&(console.log(o,o.data),a({type:"FETCH_TODOS",todos:o.data.todos}))}),[o]);o.data;var d=o.isLoading;return Object(x.jsxs)(x.Fragment,{children:[d&&"Todos loading..."," ",Object(x.jsx)(F,{})]})}var B=function(){var e=Object(n.useReducer)(O,{user:{},todos:[],bleh:""}),t=Object(s.a)(e,2),a=t[0],c=t[1],r=(a.user,a.todos),o=a.bleh;console.log(a,"--",r,o);var j=Object(n.useState)({primaryColor:"deepskyblue",secondaryColor:"coral"}),u=Object(s.a)(j,2),b=u[0],p=u[1],m=Object(i.f)({"/":Object(i.g)({view:Object(x.jsx)(G,{})}),"/todo/create":Object(i.g)({view:Object(x.jsx)(f,{})}),"/todo/:id":Object(i.g)((function(e){return{view:Object(x.jsx)(y,{id:e.params.id})}}))});return Object(x.jsx)("div",{children:Object(x.jsx)(h.b.Provider,{value:b,children:Object(x.jsx)(h.a.Provider,{value:{state:a,dispatch:c},children:Object(x.jsx)(d.b,{routes:m,children:Object(x.jsxs)(l.a,{children:[Object(x.jsx)(I,{setTheme:p}),Object(x.jsx)("hr",{}),Object(x.jsx)(d.c,{})]})})})})})},H=a(47),A=a.n(H).a.create({baseURL:"/"});o.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(p.a,{value:A,children:Object(x.jsx)(B,{})})}),document.getElementById("root"))},9:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(0),c=a.n(n),r=c.a.createContext({primaryColor:"deepskyblue",secondaryColor:"coral"}),o=c.a.createContext({state:{},dispatch:function(){}})}},[[112,1,2]]]);
//# sourceMappingURL=main.cbdfbd28.chunk.js.map