(this.webpackJsonpinclassdemo=this.webpackJsonpinclassdemo||[]).push([[0],{112:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(28),s=a.n(c),o=a(5),i=a(14),d=a(10),u=a(119),j=a(34);function l(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function b(e,t){return"FETCH_USERS"===t.type?t.users:e}function O(e,t){switch(console.log("tr",e,t),t.type){case"CREATE_TODO":return[{id:t.id,title:t.title,description:t.description,author:t.author,completed:!1,dateCompleted:-1,hidden:!1}].concat(Object(j.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e._id===t.todoId&&(e.completed=t.completed,e.dateCompleted=t.dateCompleted),e}));case"DELETE_TODO":return e.filter((function(e){return e._id!==t.todoId}));case"FETCH_TODOS":return t.todos;case"FETCH_TODO":return t.todo;default:return e}}function h(e,t){return{user:l(e.user,t),todos:O(e.todos,t),users:b(e.users,t)}}var x=a(7),p=a(12),f=a(1);function m(){var e=Object(r.useState)(""),t=Object(o.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(""),s=Object(o.a)(c,2),i=s[0],u=s[1],j=Object(d.d)(),l=Object(r.useContext)(x.a),b=l.state,O=l.dispatch,h=b.user,m=Object(p.b)((function(e){var t=e.title,a=e.description,r=e.author;return{url:"/todo",method:"post",headers:{Authorization:"".concat(b.user.access_token)},data:{title:t,description:a,author:r,dateCreated:Date.now(),complete:!1,dateCompleted:-1,hidden:!1}}})),g=Object(o.a)(m,2),v=g[0],C=g[1];return Object(r.useEffect)((function(){v&&v.data&&(O({type:"CREATE_TODO",title:v.data.title,description:v.data.description,id:v.data.id,author:h.username}),j.navigate("/todo/".concat(v.data.id)))}),[v]),Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),C({title:a,description:i,author:h.username})},children:[Object(f.jsxs)("div",{children:["Author: ",Object(f.jsx)("b",{children:h.username})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(f.jsx)("input",{type:"text",value:a,onChange:function(e){n(e.target.value)},name:"create-title",id:"create-title"})]}),Object(f.jsx)("textarea",{value:i,onChange:function(e){u(e.target.value)}}),Object(f.jsx)("input",{type:"submit",value:"Create"})]})}var g=a(2),v=a(125),C=a(80);function y(e){var t=e.title,a=e.description,n=e.author,c=e.completed,s=e.dateCompleted,i=e.todoId,u=e.short,j=void 0!==u&&u,l=e._id;void 0==i&&(i=l);var b=Object(r.useContext)(x.b).secondaryColor,O=Object(r.useContext)(x.a),h=O.state,m=O.dispatch,g=Object(d.d)(),y=Object(p.b)((function(e){return{url:"/todo/".concat(e),method:"delete",headers:{Authorization:"".concat(h.user.access_token)}}})),w=Object(o.a)(y,2),E=w[0],T=w[1],k=Object(p.b)((function(e,t){return{url:"/todo/".concat(e,"/").concat(t),method:"patch",headers:{Authorization:"".concat(h.user.access_token)}}})),_=Object(o.a)(k,2),L=_[0],S=_[1];Object(r.useEffect)((function(){E&&E.data&&(1==E.data.deletedCount?(m({type:"DELETE_TODO",todoId:i}),-1!=document.location.href.indexOf("/todo/")&&g.navigate("/")):alert("Unauthorized!"))}),[E]),Object(r.useEffect)((function(){L&&L.data&&!1===L.isLoading&&(console.log("tt",L),1==L.data.updateCount.modifiedCount?(m({type:"TOGGLE_TODO",completed:L.data.completed,dateCompleted:L.data.dateCompleted,todoId:i}),-1!=document.location.href.indexOf("/todo/")&&g.navigate("/")):alert("Unauthorized!"))}),[L]);var R=a;return j&&a.length>30&&(R=a.substring(0,30)+"..."),Object(f.jsx)(v.a,{children:Object(f.jsxs)(v.a.Body,{children:[Object(f.jsx)(v.a.Title,{children:Object(f.jsx)(d.a,{style:{color:b},href:"/todo/".concat(i),children:t})}),Object(f.jsx)(v.a.Subtitle,{children:Object(f.jsxs)("i",{children:["Written by ",Object(f.jsx)("b",{children:n})]})}),Object(f.jsx)(v.a.Text,{children:R}),Object(f.jsx)("input",{type:"checkbox",checked:c,onChange:function(e){S(i,e.target.checked)}}),Object(f.jsx)(C.a,{variant:"link",onClick:function(e){T(i)},children:"Delete Todo"}),c&&Object(f.jsxs)("i",{children:["Completed on: ",new Date(s).toLocaleDateString("en-us")]}),j&&Object(f.jsx)(d.a,{href:"/todo/".concat(i),children:"View full todo"})]})})}var w=n.a.memo(y);function E(e){var t=e.id,a=Object(r.useContext)(x.a),n=a.state,c=(a.dispatch,Object(p.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(n.user.access_token)},method:"get"}}))),s=Object(o.a)(c,2),i=s[0],u=s[1];Object(r.useEffect)(u,[t]);i.data,i.isLoading;return Object(f.jsxs)(f.Fragment,{children:[!1!==i.isLoading&&"Todo loading..."," ",Object(f.jsx)(w,Object(g.a)({},i.data)),Object(f.jsx)("div",{children:Object(f.jsx)(d.a,{href:"/",children:"Go back"})})]})}var T=a(123),k=a(121);function _(e){var t=e.show,a=e.handleClose,n=Object(r.useContext)(x.a).dispatch,c=Object(r.useState)({username:"",password:"",passwordRepeat:""}),s=Object(o.a)(c,2),i=s[0],d=s[1],u=Object(r.useState)(""),j=Object(o.a)(u,2),l=(j[0],j[1]),b=Object(p.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),O=Object(o.a)(b,2),h=O[0],m=O[1];return Object(r.useEffect)((function(){h&&h.data&&n({type:"REGISTER",username:h.data.username})}),[h]),Object(r.useEffect)((function(){h&&!1===h.isLoading&&(h.data||h.error)&&(h.error?(console.log(h),l("Registration failed, please try again later."),alert("fail")):(console.log(h),l("Registration successful. You may now login."),alert("success")))}),[h]),Object(f.jsx)(T.a,{show:t,onHide:a,children:Object(f.jsxs)(k.a,{onSubmit:function(e){e.preventDefault(),m(i.username,i.password),a()},children:[Object(f.jsx)(T.a.Header,{closeButton:!0,children:Object(f.jsx)(T.a.Title,{children:"Register"})}),Object(f.jsxs)(T.a.Body,{children:[Object(f.jsx)(k.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(f.jsx)(k.a.Control,{type:"text",value:i.username,onChange:function(e){return d(Object(g.a)(Object(g.a)({},i),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(f.jsx)(k.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(f.jsx)(k.a.Control,{type:"password",name:"register-password",id:"register-password",value:i.password,onChange:function(e){return d(Object(g.a)(Object(g.a)({},i),{},{password:e.target.value}))}}),Object(f.jsx)(k.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(f.jsx)(k.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:i.passwordRepeat,onChange:function(e){return d(Object(g.a)(Object(g.a)({},i),{},{passwordRepeat:e.target.value}))}})]}),Object(f.jsxs)(T.a.Footer,{children:[Object(f.jsx)(C.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(f.jsx)(C.a,{variant:"primary",type:"submit",disabled:0===i.username.length||0===i.password.length||i.password!==i.passwordRepeat,children:"Register"})]})]})})}function L(e){var t=e.show,a=e.handleClose,n=Object(r.useContext)(x.a).dispatch,c=Object(r.useState)(""),s=Object(o.a)(c,2),i=s[0],d=s[1],u=Object(r.useState)(""),j=Object(o.a)(u,2),l=j[0],b=j[1],O=Object(r.useState)(!1),h=Object(o.a)(O,2),m=h[0],g=h[1];var v=Object(p.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),y=Object(o.a)(v,2),w=y[0],E=y[1];return Object(r.useEffect)((function(){w&&!1===w.isLoading&&(w.data||w.error)&&(w.error?(g(!0),alert("failed")):(g(!1),console.log(w.data),n({type:"LOGIN",username:i,access_token:w.data.access_token})))}),[w]),Object(f.jsx)(T.a,{show:t,onHide:a,children:Object(f.jsxs)(k.a,{onSubmit:function(e){e.preventDefault(),E(i,l),a()},children:[Object(f.jsx)(T.a.Header,{closeButton:!0,children:Object(f.jsx)(T.a.Title,{children:"Login"})}),Object(f.jsxs)(T.a.Body,{children:[Object(f.jsx)(k.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(f.jsx)(k.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(f.jsx)(k.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(f.jsx)(k.a.Control,{type:"password",value:l,onChange:function(e){b(e.target.value)},name:"login-password",id:"login-password"}),m&&Object(f.jsx)(k.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(f.jsxs)(T.a.Footer,{children:[Object(f.jsx)(C.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(f.jsx)(C.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})}function S(){var e=n.a.lazy((function(){return a.e(3).then(a.bind(null,126))})),t=Object(r.useContext)(x.a).state,c=Object(r.useState)(!1),s=Object(o.a)(c,2),i=s[0],d=s[1],u=Object(r.useState)(!1),j=Object(o.a)(u,2),l=j[0],b=j[1];return t.user.username?Object(f.jsx)(e,{}):Object(f.jsxs)("div",{className:"justify-content-end",children:[Object(f.jsx)(C.a,{variant:"link",onClick:function(e){return d(!0)},children:"Login"}),Object(f.jsx)(L,{show:i,handleClose:function(){return d(!1)}}),Object(f.jsx)(C.a,{variant:"link",onClick:function(e){return b(!0)},children:"Register"}),Object(f.jsx)(_,{show:l,handleClose:function(){return b(!1)}})]})}var R=a(122),D=function(e){var t=e.text,a=Object(r.useContext)(x.b);return Object(f.jsx)(d.a,{href:"/",children:Object(f.jsx)(R.a.Brand,{style:{color:a.primaryColor},children:t})})};a(120);var F=a(124);function I(e){e.setTheme,Object(r.useContext)(x.b);var t=Object(r.useContext)(x.a).state.user;return Object(f.jsx)(R.a,{bg:"light",expand:"lg",children:Object(f.jsxs)(u.a,{children:[Object(f.jsx)(R.a.Brand,{href:"/",children:Object(f.jsx)(D,{text:"My Blog"})}),Object(f.jsx)(R.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(f.jsxs)(R.a.Collapse,{id:"basic-navbar-nav",children:[Object(f.jsx)(F.a,{className:"me-auto",children:t.username&&Object(f.jsx)(F.a.Link,{children:Object(f.jsx)(d.a,{href:"/todo/create",children:"Create New Todo"})})}),Object(f.jsx)(n.a.Suspense,{fallback:"Loading...",children:Object(f.jsx)(S,{})})]})]})})}function G(e){var t=e.username,a=e.userid,n=(e.todos,e.short),c=void 0!==n&&n,s=Object(r.useContext)(x.b).secondaryColor,o=Object(r.useContext)(x.a);o.state,o.dispatch,Object(d.d)();return Object(f.jsx)(v.a,{children:Object(f.jsxs)(v.a.Body,{children:[Object(f.jsx)(v.a.Title,{children:Object(f.jsx)(d.a,{style:{color:s},href:"/users/".concat(a),children:t})}),c&&Object(f.jsx)(d.a,{href:"/users/".concat(a),children:"View user's todos"})]})})}var B=n.a.memo(G);function z(){var e=Object(r.useContext)(x.a).state.users;return Object(f.jsx)("div",{children:e.map((function(e,t){return Object(r.createElement)(B,Object(g.a)(Object(g.a)({},e),{},{short:!0,username:e.username,key:"todo-"+t,todos:e.todos,userid:e._id}))}))})}function A(){var e=Object(r.useContext)(x.a),t=e.state,a=e.dispatch,n=Object(p.b)((function(){return{url:"/users",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),c=Object(o.a)(n,2),s=c[0],i=c[1];Object(r.useEffect)((function(){i()}),[t.user.access_token]),Object(r.useEffect)((function(){s&&!1===s.isLoading&&s.data&&a({type:"FETCH_USERS",users:s.data.users})}),[s]);s.data;var d=s.isLoading;return Object(f.jsxs)(f.Fragment,{children:[d&&"Users loading..."," ",Object(f.jsx)(z,{})]})}function H(){var e=Object(r.useContext)(x.a).state,t=e.todos;return console.log(e,t),Object(f.jsx)("div",{children:t.map((function(e,t){return Object(r.createElement)(w,Object(g.a)(Object(g.a)({},e),{},{short:!0,title:e.title,author:e.author,key:"todo-"+t,todoId:e._id}))}))})}function U(e){var t=e.userid,a=Object(r.useContext)(x.a),n=a.state,c=a.dispatch,s=Object(p.b)((function(){return{url:"/users/".concat(t,"/todos"),method:"get",headers:{Authorization:"".concat(n.user.access_token)}}})),i=Object(o.a)(s,2),u=i[0],j=i[1];Object(r.useEffect)((function(){j()}),[n.user.access_token]),Object(r.useEffect)((function(){u&&!1===u.isLoading&&u.data&&c({type:"FETCH_TODOS",todos:u.data.todos})}),[u]);u.data;var l=u.isLoading;return Object(f.jsxs)(f.Fragment,{children:[l&&"Todos loading..."," ",Object(f.jsx)(H,{}),Object(f.jsx)("div",{children:Object(f.jsx)(d.a,{href:"/",children:"Go back"})})]})}var N=function(){var e=Object(r.useReducer)(h,{user:{},todos:[],users:[]}),t=Object(o.a)(e,2),a=t[0],n=t[1],c=(a.user,a.todos,a.users,Object(r.useState)({primaryColor:"deepskyblue",secondaryColor:"coral"})),s=Object(o.a)(c,2),j=s[0],l=s[1],b=Object(i.f)({"/":Object(i.g)({view:Object(f.jsx)(A,{})}),"/todo/create":Object(i.g)({view:Object(f.jsx)(m,{})}),"/todo/:id":Object(i.g)((function(e){return{view:Object(f.jsx)(E,{id:e.params.id})}})),"/users/:userid":Object(i.g)((function(e){return{view:Object(f.jsx)(U,{userid:e.params.userid})}}))});return Object(f.jsx)("div",{children:Object(f.jsx)(x.b.Provider,{value:j,children:Object(f.jsx)(x.a.Provider,{value:{state:a,dispatch:n},children:Object(f.jsx)(d.b,{routes:b,children:Object(f.jsxs)(u.a,{children:[Object(f.jsx)(I,{setTheme:l}),Object(f.jsx)("hr",{}),Object(f.jsx)(d.c,{})]})})})})})},P=a(47),J=a.n(P).a.create({baseURL:"/"});s.a.render(Object(f.jsx)(n.a.StrictMode,{children:Object(f.jsx)(p.a,{value:J,children:Object(f.jsx)(N,{})})}),document.getElementById("root"))},7:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s}));var r=a(0),n=a.n(r),c=n.a.createContext({primaryColor:"deepskyblue",secondaryColor:"coral"}),s=n.a.createContext({state:{},dispatch:function(){}})}},[[112,1,2]]]);
//# sourceMappingURL=main.162c46ad.chunk.js.map